<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sumobot Monitor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-green-400 min-h-screen flex flex-col items-center justify-center font-mono">

<h1 class="text-2xl mb-4">ðŸ¤– Sumobot Monitor</h1>

<p id="status" class="text-red-400 mb-4">Desconectado</p>

<button id="connectBtn"
class="bg-indigo-600 text-white px-6 py-3 rounded-lg mb-4">
Conectar BLE
</button>

<div id="log"
class="bg-gray-900 w-96 h-80 p-4 overflow-y-auto rounded-lg text-sm">
Esperando datos...
</div>

<script>
const UART_SERVICE = '6e400001-b5a3-f393-e0a9-e50e24dcca9e';
const UART_RX = '6e400003-b5a3-f393-e0a9-e50e24dcca9e';

let characteristic;

document.getElementById("connectBtn").onclick = async () => {
    const device = await navigator.bluetooth.requestDevice({
        filters: [{ services: [UART_SERVICE] }]
    });

    const server = await device.gatt.connect();
    const service = await server.getPrimaryService(UART_SERVICE);
    characteristic = await service.getCharacteristic(UART_RX);

    await characteristic.startNotifications();
    characteristic.addEventListener('characteristicvaluechanged', handleData);

    document.getElementById("status").textContent = "Conectado a " + device.name;
    document.getElementById("status").className = "text-green-400 mb-4";
};

function handleData(event) {
    const value = new TextDecoder().decode(event.target.value);
    const logDiv = document.getElementById("log");

    logDiv.innerHTML += "<div>> " + value + "</div>";
    logDiv.scrollTop = logDiv.scrollHeight;
}
</script>

</body>
</html>
